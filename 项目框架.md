好的 ✅ 我来帮你写一版**前后端骨架代码**（前端：React + Vite + Tailwind，后端：FastAPI + WebSocket），并且写上**详细中文注释**，这样你第一次做大型项目也能理解。

------

# 一、项目目录结构（推荐）

```
ai-roleplay-chat/
├── backend/                # 后端代码目录
│   ├── app/
│   │   ├── main.py         # FastAPI 主入口
│   │   ├── api/            # API 路由
│   │   │   ├── chat.py     # 聊天相关接口（调用 LLM、语音识别、TTS）
│   │   │   └── roles.py    # 角色搜索/管理接口
│   │   ├── core/           # 核心配置
│   │   │   ├── config.py   # 全局配置（API Key、模型配置）
│   │   │   └── llm_client.py # LLM 调用工具
│   │   ├── models/         # 数据模型
│   │   │   └── role.py     # 角色信息模型
│   │   └── services/       # 服务逻辑
│   │       ├── tts.py      # 文本转语音服务
│   │       ├── asr.py      # 语音转文本服务
│   │       └── chat_service.py # 聊天服务封装
│   └── requirements.txt    # 后端依赖
│
├── frontend/               # 前端代码目录
│   ├── src/
│   │   ├── App.jsx         # React 主入口
│   │   ├── pages/          # 页面
│   │   │   └── ChatPage.jsx # 聊天页面
│   │   ├── components/     # 可复用组件
│   │   │   ├── ChatBox.jsx # 聊天框组件
│   │   │   └── AudioRecorder.jsx # 语音录制按钮
│   │   ├── services/       # API 请求封装
│   │   │   ├── api.js      # 通用请求工具
│   │   │   └── chat.js     # 聊天 API 调用
│   └── package.json        # 前端依赖
│
└── README.md               # 项目说明
```

------

# 二、后端骨架代码（FastAPI）

📌 `backend/app/main.py`

```
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from app.api import chat, roles

# 创建 FastAPI 应用
app = FastAPI(title="AI 角色扮演 API")

# 配置跨域 (允许前端访问)
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],  # 开发阶段允许所有来源，生产环境要改
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# 注册路由
app.include_router(chat.router, prefix="/chat", tags=["Chat"])
app.include_router(roles.router, prefix="/roles", tags=["Roles"])

# 健康检查接口
@app.get("/health")
def health_check():
    return {"status": "ok"}
```

📌 `backend/app/api/chat.py`

```
from fastapi import APIRouter
from pydantic import BaseModel
from app.core.llm_client import call_llm

router = APIRouter()

# 请求体模型
class ChatRequest(BaseModel):
    role: str   # 角色名字，例如 "哈利波特"
    message: str # 用户输入

class ChatResponse(BaseModel):
    reply: str  # AI 回复文本

@router.post("/")
def chat(req: ChatRequest):
    """
    聊天接口：
    输入：角色 + 用户消息
    输出：AI 回复文本
    """
    reply = call_llm(req.role, req.message)
    return ChatResponse(reply=reply)
```

📌 `backend/app/core/llm_client.py`

```
"""
这里封装 LLM 调用逻辑，可以换成 OpenAI、Deepseek 等。
未来如果要切换模型，只改这里。
"""
def call_llm(role: str, message: str) -> str:
    # 模拟调用大模型接口
    # TODO: 替换为真实 API 请求
    return f"[{role}的回答]：你好！你刚才说的是 '{message}'"
```

------

# 三、前端骨架代码（React）

📌 `frontend/src/App.jsx`

```
import { useState } from "react";
import ChatPage from "./pages/ChatPage";

function App() {
  return (
    <div className="h-screen w-screen bg-gray-100 flex items-center justify-center">
      <ChatPage />
    </div>
  );
}

export default App;
```

📌 `frontend/src/pages/ChatPage.jsx`

```
import { useState } from "react";
import ChatBox from "../components/ChatBox";
import { sendChat } from "../services/chat";

function ChatPage() {
  const [messages, setMessages] = useState([]);

  const handleSend = async (text) => {
    // 添加用户消息
    setMessages([...messages, { sender: "user", text }]);

    // 调用后端 API 获取 AI 回复
    const res = await sendChat("哈利波特", text);
    setMessages((prev) => [...prev, { sender: "ai", text: res.reply }]);
  };

  return (
    <div className="w-full max-w-2xl bg-white p-4 rounded shadow-md">
      <h1 className="text-xl font-bold mb-4">AI 角色扮演</h1>
      <ChatBox messages={messages} onSend={handleSend} />
    </div>
  );
}

export default ChatPage;
```

📌 `frontend/src/components/ChatBox.jsx`

```
import { useState } from "react";

function ChatBox({ messages, onSend }) {
  const [input, setInput] = useState("");

  const handleSend = () => {
    if (input.trim()) {
      onSend(input);
      setInput("");
    }
  };

  return (
    <div>
      <div className="h-64 overflow-y-auto border p-2 mb-2">
        {messages.map((m, i) => (
          <div key={i} className={m.sender === "user" ? "text-right" : "text-left"}>
            <span
              className={`inline-block p-2 my-1 rounded ${
                m.sender === "user" ? "bg-blue-200" : "bg-green-200"
              }`}
            >
              {m.text}
            </span>
          </div>
        ))}
      </div>
      <div className="flex">
        <input
          className="flex-1 border p-2 rounded-l"
          value={input}
          onChange={(e) => setInput(e.target.value)}
          placeholder="输入消息..."
        />
        <button className="bg-blue-500 text-white px-4 rounded-r" onClick={handleSend}>
          发送
        </button>
      </div>
    </div>
  );
}

export default ChatBox;
```

📌 `frontend/src/services/chat.js`

```
export async function sendChat(role, message) {
  const res = await fetch("http://localhost:8000/chat/", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ role, message }),
  });
  return res.json();
}
```

------

# 四、编辑器 & 开发环境

- **编辑器推荐**：

  - **VS Code**（跨平台、插件多，比如 REST Client 调试 API，Tailwind CSS 自动补全）
  - 或者 **PyCharm（后端）+ WebStorm（前端）** 分开管理

- **运行方式**：

  1. 后端

     ```
     cd backend
     pip install -r requirements.txt
     uvicorn app.main:app --reload
     ```

  2. 前端

     ```
     cd frontend
     npm install
     npm run dev
     ```

------

要不要我接下来帮你写一个**详细的开发计划表**（第1周做哪些，怎么跑起来，第2周再加语音功能，第3周再加角色技能）？这样你就能跟着执行了。

##### 